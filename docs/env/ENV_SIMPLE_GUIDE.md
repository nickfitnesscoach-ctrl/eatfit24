# ENV ‚Äî –ø—Ä–æ—Å—Ç–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –¥–ª—è EatFit24 (–¥–ª—è –º–µ–Ω—è)

## 1. –ß—Ç–æ —Ç–∞–∫–æ–µ ENV –ø–æ-—á–µ–ª–æ–≤–µ—á–µ—Å–∫–∏

ENV ‚Äî —ç—Ç–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞, –∫–æ—Ç–æ—Ä—ã–µ –ù–ï –∫–æ–¥.

- **–∫–æ–¥** ‚Üí –∫–∞–∫ —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
- **env** ‚Üí –≤ –∫–∞–∫–∏—Ö —É—Å–ª–æ–≤–∏—è—Ö –æ–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–ü—Ä–∏–º–µ—Ä:**
- –∫–æ–¥: ¬´–≤–∫–ª—é—á–∏ –æ–ø–ª–∞—Ç—É¬ª
- env: `YOOKASSA_MODE=prod`

üëâ –û–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∫–æ–¥, –Ω–æ —Ä–∞–∑–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ.

---

## 2. –ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ (–∑–∞–ø–æ–º–Ω–∏—Ç—å –Ω–∞–≤—Å–µ–≥–¥–∞)

> [!CAUTION]
> **–°–ï–ö–†–ï–¢–´ –ù–ò–ö–û–ì–î–ê –ù–ï –í –ö–û–î–ï –ò –ù–ï –í GIT**

–ï—Å–ª–∏ —ç—Ç–æ:
- –ø–∞—Ä–æ–ª—å
- —Ç–æ–∫–µ–Ω
- API-–∫–ª—é—á
- secret

‚û°Ô∏è –µ–º—É –º–µ—Å—Ç–æ **—Ç–æ–ª—å–∫–æ** –≤ env

---

## 3. –ö–∞–∫ ENV —É—Å—Ç—Ä–æ–µ–Ω—ã –≤ EatFit24 (–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ö–µ–º–∞)

```
/opt/EatFit24/
‚îú‚îÄ‚îÄ .env                ‚Üê –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–ù–ï —Å–µ–∫—Ä–µ—Ç—ã)
‚îú‚îÄ‚îÄ .env.example        ‚Üê —à–∞–±–ª–æ–Ω (–≤ git)
‚îú‚îÄ‚îÄ env/
‚îÇ   ‚îú‚îÄ‚îÄ backend.env     ‚Üê –í–°–ï —Å–µ–∫—Ä–µ—Ç—ã backend
‚îÇ   ‚îî‚îÄ‚îÄ bot.env         ‚Üê —Å–µ–∫—Ä–µ—Ç—ã Telegram-–±–æ—Ç–∞
‚îú‚îÄ‚îÄ docker-compose.yml
```

---

## 4. –ß—Ç–æ –ª–µ–∂–∏—Ç –≤ –∫–∞–∂–¥–æ–º —Ñ–∞–π–ª–µ

### `.env` ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –Ω–µ —Å–µ–∫—Ä–µ—Ç—ã

–ó–¥–µ—Å—å —Ä–∞–∑—Ä–µ—à–µ–Ω–æ:
- –¥–æ–º–µ–Ω—ã
- URL
- —Ñ–ª–∞–≥–∏
- —Ä–µ–∂–∏–º—ã
- ID –∞–¥–º–∏–Ω–æ–≤

**–ü—Ä–∏–º–µ—Ä:**
```env
ENVIRONMENT=production
DEBUG=False
DEBUG_MODE_ENABLED=False

ALLOWED_HOSTS=eatfit24.ru,www.eatfit24.ru
CORS_ALLOWED_ORIGINS=https://eatfit24.ru

TELEGRAM_ADMINS=310151740
```

üëâ `.env` –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–µ–∫—Ä–µ—Ç–æ–≤, –Ω–æ –æ—Å—Ç–∞—ë—Ç—Å—è –ø—Ä–∏–≤–∞—Ç–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –ø—Ä–æ–µ–∫—Ç–∞.

---

### `env/backend.env` ‚Äî —Å–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ

–ó–¥–µ—Å—å **–¢–û–õ–¨–ö–û** —Å–µ–∫—Ä–µ—Ç—ã:

```env
SECRET_KEY=***
POSTGRES_PASSWORD=***
TELEGRAM_BOT_TOKEN=***
OPENROUTER_API_KEY=***
YOOKASSA_API_KEY_PROD=***
AI_PROXY_SECRET=***
```

üëâ –≠—Ç–æ—Ç —Ñ–∞–π–ª:
- ‚ùå –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤ git
- ‚ùå –Ω–∏–∫–æ–≥–¥–∞ –≤ —á–∞—Ç
- ‚ùå –Ω–∏–∫–æ–≥–¥–∞ –≤ README

---

### `env/bot.env` ‚Äî —Å–µ–∫—Ä–µ—Ç—ã –±–æ—Ç–∞ (API-only)

> **Updated 2025-12-24:** –ë–æ—Ç –±–æ–ª—å—à–µ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç DB_* –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ Django API.

```env
TELEGRAM_BOT_TOKEN=***
TELEGRAM_BOT_API_SECRET=***
OPENROUTER_API_KEY=***
DJANGO_API_URL=http://backend:8000/api/v1
```

---

## 5. –ö–∞–∫ Docker —ç—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç

–í `docker-compose.yml`:

```yaml
services:
  backend:
    env_file:
      - .env
      - env/backend.env
```

Docker:
1. —Å–Ω–∞—á–∞–ª–∞ —á–∏—Ç–∞–µ—Ç `.env`
2. –ø–æ—Ç–æ–º –¥–æ–±–∞–≤–ª—è–µ—Ç `backend.env`
3. –µ—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è ‚Üí –ø–æ–±–µ–∂–¥–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω—è—è

---

## 6. –ß—Ç–æ –ó–ê–ü–†–ï–©–ï–ù–û –¥–µ–ª–∞—Ç—å

| üö´ –ó–∞–ø—Ä–µ—â–µ–Ω–æ | –ü–æ—á–µ–º—É |
|-------------|--------|
| `DEBUG=True` –≤ –ø—Ä–æ–¥–µ | –£—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö |
| `DEBUG_MODE_ENABLED=True` –≤ –ø—Ä–æ–¥–µ | –û–±—Ö–æ–¥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ |
| `changeme`, `test`, `123456` | –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ |
| `*` –≤ CORS | –£—è–∑–≤–∏–º–æ—Å—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ |
| –î—É–±–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö | –ù–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ |
| `VITE_*` —Å —Å–µ–∫—Ä–µ—Ç–∞–º–∏ | –ü–æ–ø–∞–¥—É—Ç –≤ –±–∞–Ω–¥–ª |
| –¢–æ–∫–µ–Ω—ã –≤ –∫–æ–¥–µ | –£—Ç–µ—á–∫–∞ —á–µ—Ä–µ–∑ git |

---

## 7. –ë—ã—Å—Ç—Ä—ã–π —á–µ–∫ –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º (30 —Å–µ–∫—É–Ω–¥)

–ü–µ—Ä–µ–¥ –ª—é–±—ã–º –¥–µ–ø–ª–æ–µ–º:

- [ ] `DEBUG=False`
- [ ] `DEBUG_MODE_ENABLED=False`
- [ ] –Ω–µ—Ç `changeme`
- [ ] –Ω–µ—Ç `*` –≤ CORS
- [ ] —Å–µ–∫—Ä–µ—Ç—ã —Ç–æ–ª—å–∫–æ –≤ `env/*.env`
- [ ] `.env.example` –æ–±–Ω–æ–≤–ª—ë–Ω

---

## 8. –ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –¥—É–º–∞—Ç—å –ø—Ä–æ ENV

–ó–∞–ø–æ–º–Ω–∏ —Ñ–æ—Ä–º—É–ª—É:

> **ENV = –∫–æ–Ω—Ç—Ä–∞–∫—Ç –º–µ–∂–¥—É –∫–æ–¥–æ–º –∏ —Å–µ—Ä–≤–µ—Ä–æ–º**

- –∫–æ–¥ –æ–∂–∏–¥–∞–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
- env –æ–±—è–∑–∞–Ω –∏—Ö –¥–∞—Ç—å
- –µ—Å–ª–∏ env —Å–ª–æ–º–∞–Ω ‚Äî –∫–æ–¥ –Ω–∏ –ø—Ä–∏ —á—ë–º

---

## 9. –ü–æ—á–µ–º—É —Ä–∞–Ω—å—à–µ –±—ã–ª –±–∞—Ä–¥–∞–∫ ‚Äî –∏ –ø–æ—á–µ–º—É —ç—Ç–æ –æ–∫

–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π —ç—Ç–∞–ø, –∫–æ–≥–¥–∞:
- –ø—Ä–æ–µ–∫—Ç —Ä–∞—Å—Ç—ë—Ç
- –ø–æ—è–≤–ª—è–µ—Ç—Å—è Docker
- –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –±–æ—Ç—ã, –±–∏–ª–ª–∏–Ω–≥, AI

–¢—ã —ç—Ç–æ—Ç —ç—Ç–∞–ø —É–∂–µ –ø—Ä–æ—à—ë–ª.
–¢–µ–ø–µ—Ä—å —É —Ç–µ–±—è –≤–∑—Ä–æ—Å–ª–∞—è —Å—Ö–µ–º–∞.

---

## 10. –ò—Ç–æ–≥

–¢–µ–ø–µ—Ä—å:

‚úîÔ∏è —Ç—ã –ø–æ–Ω–∏–º–∞–µ—à—å, –≥–¥–µ —á—Ç–æ –ª–µ–∂–∏—Ç  
‚úîÔ∏è –Ω–µ —Å–æ–ª—å—ë—à—å –ø—Ä–æ–¥  
‚úîÔ∏è –º–æ–∂–µ—à—å –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç  
‚úîÔ∏è —ç—Ç–æ —É—Ä–æ–≤–µ–Ω—å SaaS, –∞ –Ω–µ –ø–µ—Ç-–ø—Ä–æ–µ–∫—Ç–∞

---

## 11. –í–∞–∂–Ω–æ: frontend env ‚Äî build args, –∞ –Ω–µ —Ñ–∞–π–ª—ã

> [!CAUTION]
> **`.env.production` –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏ –ù–ï –¥–æ–ª–∂–µ–Ω —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å!**

### –ö–∞–∫ frontend –ø–æ–ª—É—á–∞–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

**–í production (–Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ):**
```
docker-compose.yml ‚Üí build.args
    ‚Üì
Dockerfile ‚Üí ARG ‚Üí ENV
    ‚Üì
npm run build (Vite —á–∏—Ç–∞–µ—Ç ENV)
    ‚Üì
JS bundle (–∑–Ω–∞—á–µ–Ω–∏—è –≤—à–∏—Ç—ã)
```

**–í development (–ª–æ–∫–∞–ª—å–Ω–æ):**
```
frontend/.env.development ‚Üí Vite ‚Üí –±—Ä–∞—É–∑–µ—Ä
```

### –ß—Ç–æ –º–æ–∂–Ω–æ, —á—Ç–æ –Ω–µ–ª—å–∑—è

‚ö†Ô∏è –í—Å–µ `VITE_*` –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
- –≤—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤ JS-–±–∞–Ω–¥–ª
- –¥–æ—Å—Ç—É–ø–Ω—ã –ª—é–±–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —á–µ—Ä–µ–∑ DevTools
- **–ø—É–±–ª–∏—á–Ω—ã–µ –ø–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é**

‚úÖ –ü—Ä–∏–º–µ—Ä—ã –¥–æ–ø—É—Å—Ç–∏–º–æ–≥–æ:
- `VITE_API_URL=/api/v1` ‚Äî –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å
- `VITE_TELEGRAM_BOT_NAME=EatFit24_bot` ‚Äî –ø—É–±–ª–∏—á–Ω–æ–µ –∏–º—è
- `VITE_TRAINER_INVITE_LINK=https://t.me/EatFit24_bot` ‚Äî –ø—É–±–ª–∏—á–Ω–∞—è —Å—Å—ã–ª–∫–∞

üö´ –í–æ frontend –ù–ï–õ–¨–ó–Ø —Ö—Ä–∞–Ω–∏—Ç—å:
- —Ç–æ–∫–µ–Ω—ã (`VITE_SECRET_KEY` ‚ùå)
- API-–∫–ª—é—á–∏ (`VITE_API_KEY` ‚ùå)
- –ø–∞—Ä–æ–ª–∏
- –ª—é–±—ã–µ —Å–µ–∫—Ä–µ—Ç—ã

### –ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ

> **–ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –æ—Å—Ç–∞—Ç—å—Å—è —Å–µ–∫—Ä–µ—Ç–æ–º ‚Äî –æ–Ω–∏ –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å –≤–æ frontend.**
>
> –°–µ–∫—Ä–µ—Ç—ã –∂–∏–≤—É—Ç —Ç–æ–ª—å–∫–æ –≤ backend.

### –ü–æ—á–µ–º—É .env.production –∑–∞–ø—Ä–µ—â—ë–Ω

–ö–æ–≥–¥–∞ Dockerfile –¥–µ–ª–∞–µ—Ç `COPY .env.production .`, —ç—Ç–æ—Ç —Ñ–∞–π–ª:
1. –ü–æ–ø–∞–¥–∞–µ—Ç –≤ Docker layer
2. –û—Å—Ç–∞—ë—Ç—Å—è –≤ image –Ω–∞–≤—Å–µ–≥–¥–∞
3. –ú–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑–≤–ª–µ—á—ë–Ω –∏–∑ –æ–±—Ä–∞–∑–∞

–î–∞–∂–µ –µ—Å–ª–∏ —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –ø—É–±–ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ ‚Äî —ç—Ç–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ.

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ:**
```yaml
# docker-compose.yml
frontend:
  build:
    args:
      - VITE_API_URL=/api/v1
```

**–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:**
```dockerfile
# ‚ùå –ù–ï –î–ï–õ–ê–ô –¢–ê–ö
COPY .env.production .
RUN npm run build
```

---

## Changelog

### Version 2.0 - 2025-12-22

**Updated:** Alignment with Docker build-args frontend architecture

**Changes:**
1. Section 4 (`.env` file):
   - Changed formulation from "–µ—Å–ª–∏ —É—Ç–µ—á—ë—Ç ‚Äî –Ω–∏—á–µ–≥–æ —Å—Ç—Ä–∞—à–Ω–æ–≥–æ" to "–Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–µ–∫—Ä–µ—Ç–æ–≤, –Ω–æ –æ—Å—Ç–∞—ë—Ç—Å—è –ø—Ä–∏–≤–∞—Ç–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π"

2. Section 11 (Frontend env) - **Major Rewrite:**
   - Added CAUTION: `.env.production` must NOT exist
   - Documented production build flow via docker-compose.yml build.args
   - Documented development flow via .env.development
   - Added explanation WHY .env.production is forbidden (Docker layers)
   - Added correct/incorrect examples
   - Made explicit: secrets cannot be in frontend (belong in backend)

**Reason:** Alignment with ENV_CONTRACT.md v2.0 and production security fixes from ENV_SECURITY_FIX_2025-12-21.md

